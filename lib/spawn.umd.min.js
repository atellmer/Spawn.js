!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Spawn",[],t):"object"==typeof exports?exports.Spawn=t():e.Spawn=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e,t,n){"use strict";function r(e){return JSON.parse(JSON.stringify(e))}function o(e){e.forEach(function(e){return e()})}function i(e,t){return e.forEach(function(e){if(e===t)return!1}),!0}function u(e,t){for(var n=e.split("."),o=r(t),i=0;i<n.length;i++){if(!o.hasOwnProperty(n[i]))return null;o=o[n[i]]}return o}function c(e,t){return JSON.stringify(u(e,t))}function a(e,t){for(var n in e)e.hasOwnProperty(n)&&("*"!==n&&t(n),o(e[n]))}function f(e,t,n,r,i){for(var u in t)if(t.hasOwnProperty(u)){if(u===e){o(t[u]);continue}if(e.length<u.length&&new RegExp("^\\"+e+".","i").test(u)&&c(u,r)!==c(u,n)){o(t[u]);continue}if(e.length>u.length&&new RegExp("^\\"+u+".","i").test(e)){o(t[u]);continue}}i&&o(t["*"])}Object.defineProperty(t,"__esModule",{value:!0});var s="@@SPAWN/INIT";t.SPAWN_INIT=s,t.clone=r,t.mapSubscribers=o,t.checkCallback=i,t.findZoneValue=u,t.plainZoneValue=c,t.autorun=a,t.applyLogic=f},function(e,t,n){"use strict";function r(e){return!(!o(e)||i(e))}function o(e){return"object"===("undefined"==typeof e?"undefined":f(e))}function i(e){return Array.isArray(e)}function u(e){return"function"==typeof e}function c(e){return"string"==typeof e}function a(e){throw new Error(e)}Object.defineProperty(t,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isPlainObject=r,t.isObject=o,t.isArray=i,t.isFunc=u,t.isString=c,t.error=a},function(e,t,n){"use strict";function r(){return arguments[0]?new u(arguments[0]):new u}Object.defineProperty(t,"__esModule",{value:!0}),t.createStore=r;var o=n(0),i=n(1),u=function(){var e={},t={},n={},r={"*":[]},u=o.SPAWN_INIT;arguments[0]&&((0,i.isPlainObject)(arguments[0])||(0,i.error)("Spawn: the initial state must be plain object!"),e=arguments[0]),this.getState=function(){return(0,o.clone)(e)},this.select=function(t){if((0,i.isString)(t))switch(t){case"*":return(0,o.clone)(e);case"->":return u;default:return(0,o.findZoneValue)(t,e)}return(0,i.isFunc)(t)?t((0,o.clone)(e)):void(0,i.error)("Spawn: the select method takes only a string or function as argument!")},this.detect=function(u,c){return(0,i.isString)(u)||(0,i.error)("Spawn: the detect method takes only a string for first argument!"),(0,i.isFunc)(c)||(0,i.error)("Spawn: the detect method takes only a function for second argument!"),r[u]||(r[u]=[]),"*"===u&&(0,o.checkCallback)(r[u],c)?(r[u].push(c),(0,o.mapSubscribers)(r[u]),this):(0,o.checkCallback)(r[u],c)?(r[u].push(c),(0,o.findZoneValue)(u,e)&&(n=(0,o.clone)(e),(0,o.applyLogic)(u,r,e,t,!1)),this):this},this.update=function(c,a){(0,i.isString)(c)||(0,i.error)("Spawn: the update method takes only a string for first argument!");var f=c.split("."),s=(0,o.clone)(e),l=s;if("*"===c){if((0,i.isPlainObject)(a))return e=(0,o.clone)(a),t={},n={},u=c,(0,o.autorun)(r,function(e){return u=e}),this;(0,i.error)("Spawn: the update method takes only a plain object for replace full state! Check your update('*') method.")}u=c;for(var p=0;p<f.length;p++){if(s.hasOwnProperty(f[p])||(s[f[p]]={}),p===f.length-1){s[f[p]]=a;break}s=s[f[p]]}return n=(0,o.clone)(l),(0,o.plainZoneValue)(c,e)!==(0,o.plainZoneValue)(c,n)?(e=(0,o.clone)(n),(0,o.applyLogic)(c,r,e,t,!0),t=(0,o.clone)(n)):(0,o.mapSubscribers)(r["*"]),this}}}])});